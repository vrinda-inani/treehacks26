@import url('https://fonts.googleapis.com/css2?family=Source+Serif+4:ital,opsz,wght@0,8..60,300;0,8..60,400;0,8..60,600;0,8..60,700;1,8..60,400;1,8..60,600&family=Source+Sans+3:wght@300;400;500;600&display=swap');

@import 'tailwindcss';
@plugin "@tailwindcss/typography";

@layer base {
  :root {
    --background: 42 33% 97%;
    --foreground: 220 20% 15%;

    --primary: 152 45% 35%;
    --primary-foreground: 42 33% 97%;

    --muted: 42 15% 90%;
    --muted-foreground: 220 10% 45%;

    --accent: 152 35% 92%;

    --border: 42 20% 88%;

    --text-heading: 220 25% 12%;
    --text-body: 220 15% 25%;
    --text-subtle: 220 10% 50%;
    --surface-subtle: 42 25% 95%;
    --divider: 42 20% 85%;
    --link-hover: 152 50% 30%;

    --font-display: 'Source Serif 4', 'Georgia', 'Times New Roman', serif;
    --font-body: 'Source Serif 4', 'Georgia', 'Times New Roman', serif;
    --font-sans-alt: 'Source Sans 3', -apple-system, sans-serif;

    --shadow-sm: 0 1px 3px 0 hsl(220 20% 15% / 0.04), 0 1px 2px -1px hsl(220 20% 15% / 0.04);
  }

  * {
    border-color: hsl(var(--border));
  }

  html {
    scroll-behavior: smooth;
  }

  body {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
    font-family: var(--font-body);
    letter-spacing: 0.002em;
    line-height: 1.75;
  }

  .prose {
    font-family: var(--font-body);
    line-height: 1.75;
  }

  h1, h2, h3, h4, h5, h6 {
    font-family: var(--font-display);
    color: hsl(var(--text-heading));
  }
}

@layer components {
  .lw-content {
    font-size: 1.05rem;
    line-height: 1.75;
    letter-spacing: 0.003em;
    scroll-margin-top: 5rem;
  }

  .lw-content :where(p):not(:where([class~='not-prose'] *)) {
    color: hsl(var(--text-body));
  }

  .lw-content :where(h1):not(:where([class~='not-prose'] *)) {
    font-weight: 600;
    letter-spacing: -0.015em;
    margin-bottom: 1.5rem;
  }

  .lw-content :where(h2, h3):not(:where([class~='not-prose'] *)) {
    font-weight: 600;
    letter-spacing: -0.01em;
    margin-top: 2.5rem;
    margin-bottom: 1rem;
  }

  .lw-toc {
    font-family: var(--font-sans-alt);
    font-size: 0.95rem;
    line-height: 1.5;
    letter-spacing: 0.01em;
  }
}

/* Prose refinements */
.prose :where(a):not(:where([class~='not-prose'] *)) {
  text-decoration: underline;
  text-underline-offset: 2px;
  text-decoration-thickness: 0.08em;
  color: hsl(var(--primary));
}

.prose :where(a):not(:where([class~='not-prose'] *)):hover {
  color: hsl(var(--link-hover));
}

.prose :where(blockquote):not(:where([class~='not-prose'] *)) {
  border-left: 4px solid hsl(var(--primary));
  border-radius: 0.75rem;
  padding: 1rem 1.5rem;
  font-style: italic;
  background-color: hsla(var(--accent), 0.3);
  color: hsl(var(--text-body));
}

.prose :where(code):not(:where([class~='not-prose'], pre *)) {
  border-radius: 0.375rem;
  padding: 0.25rem 0.5rem;
  font-size: 0.9rem;
  font-weight: 500;
  background-color: hsl(var(--muted));
  color: hsl(var(--text-heading));
}

.prose :where(code):not(:where([class~='not-prose'], pre *))::before,
.prose :where(code):not(:where([class~='not-prose'], pre *))::after {
  content: none;
}

.prose :where(pre code):not(:where([class~='not-prose'] *)) {
  background-color: transparent;
  border: 0;
  padding: 0;
}

.prose :where(pre):not(:where([class~='not-prose'] *)) {
  border: 1px solid hsl(var(--border));
  border-radius: 0.75rem;
  padding: 1rem;
  overflow-x: auto;
  background-color: hsl(var(--surface-subtle));
  box-shadow: var(--shadow-sm);
}

.prose :where(kbd):not(:where([class~='not-prose'] *)) {
  color: hsl(var(--text-heading));
  font-weight: 600;
  font-size: 0.9rem;
  background-color: hsl(var(--muted));
  border-radius: 0.375rem;
  padding: 0.25rem 0.5rem;
  border: 1px solid hsl(var(--border));
  box-shadow: var(--shadow-sm);
}

.prose :where(ul.contains-task-list):not(:where([class~='not-prose'] *)) {
  list-style: none;
  padding-left: 0;
}

.prose :where(li.task-list-item > input[type='checkbox']):not(:where([class~='not-prose'] *)) {
  margin-right: 0.5rem;
  margin-left: 0.25rem;
  vertical-align: middle;
}

.prose :where(table):not(:where([class~='not-prose'] *)) {
  width: 100%;
  border-collapse: collapse;
}

.prose :where(th):not(:where([class~='not-prose'] *)) {
  border-bottom: 1px solid hsl(var(--border));
  padding-bottom: 0.5rem;
  text-align: left;
  font-weight: 600;
}

.prose :where(td):not(:where([class~='not-prose'] *)) {
  border-bottom: 1px solid hsl(var(--border));
  padding: 0.5rem 0;
  vertical-align: top;
}

/* Code block copy button */
.copy-button {
  position: absolute;
  top: 0.5rem;
  right: 0.5rem;
  padding: 0.25rem 0.5rem;
  font-size: 0.75rem;
  border-radius: 0.375rem;
  opacity: 0;
  transition: opacity 0.2s ease;
  color: hsl(var(--text-subtle));
  background-color: hsl(var(--muted));
  cursor: pointer;
  border: none;
}

.copy-button:hover {
  color: hsl(var(--text-heading));
}

.group:hover .copy-button {
  opacity: 1;
}

/* Heading anchor */
.heading-anchor {
  position: absolute;
  left: -1.5rem;
  top: 0;
  opacity: 0;
  transition: opacity 0.2s ease;
  text-decoration: none;
  user-select: none;
  color: hsl(var(--text-subtle));
}

.group:hover .heading-anchor {
  opacity: 1;
}
